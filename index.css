@media print {
    @page {
        size: letter landscape;
        margin: 0.4in 0.3in;
    }

    body {
        font-size: 10pt;
        line-height: 1.3;
    }

    /* Prevent page breaks inside rows */
    tr {
        page-break-inside: avoid;
        break-inside: avoid;
    }

    /* Allow page breaks before project headers */
    .project-header {
        page-break-before: auto;
        break-before: auto;
    }

    /* Keep subtotal with its group */
    .subtotal-row {
        page-break-after: avoid;
        break-after: avoid;
    }

    /* Keep grand total on same page if possible */
    tfoot {
        page-break-inside: avoid;
        break-inside: avoid;
        page-break-before: auto;
        break-before: auto;
    }

    /* Prevent orphan rows */
    tbody {
        orphans: 3;
        widows: 3;
    }

    /* Adjust table layout for print */
    table {
        font-size: 9pt;
    }

    th,
    td {
        padding: 4px !important;
    }

    /* Make grand total stand out */
    tfoot tr {
        font-weight: bold;
        font-size: 11pt;
    }
}